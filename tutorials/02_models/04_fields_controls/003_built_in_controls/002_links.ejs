<!-- 
/*
Copyright 2017 apHarmony

This file is part of jsHarmony.

jsHarmony is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

jsHarmony is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with this package.  If not, see <http://www.gnu.org/licenses/>.
*/
-->
<script type="text/x-tutorial-info">
{
  "ID": "field_links",
  "Title": "Links",
  "Menu": ["Models","Fields / Controls","Built-in Controls"],
  "Code": ["/models/C.json","/models/C.js"]
}
</script>

<h3>Overview / Syntax</h3>
The field.link property provides a way to perform actions or link controls to other forms and grids.  Links are available for the following controls:
<ul>
  <li>label</li>
  <li>html</li/>
  <li>button</li>
  <li>linkbutton</li>
</ul>

Links have the following actions available:
<ul>
  <li><b>insert</b>: Open a model for Insert</li>
  <li><b>browse</b>: Open a model for Browse</li>
  <li><b>update</b>: Open a model for Update</li>
  <li><b>savenew</b>: Save the current data, and open a model for Insert (Save &amp; New record)</li>
  <li><b>download</b>: Download a file</li>
  <li><b>select</b>: (Only on Popup-LOV Grid) Select the current row</li>
  <li><b>url</b>: Open a URL on click (EJS expressions supported)</li>
  <li><b>js</b>: Run a custom JavaScript expression on click</li>
</ul>

The link syntax is as follows:
<pre>
[i]link[/i] :=
  insert[i](window_options)[/i]:MODELID&amp;[i]parameter1[/i]&amp;[i]parameter2[/i]&amp;[i]parameter3[/i]&amp;...
  browse[i](window_options)[/i]:MODELID&amp;[i]parameter1[/i]&amp;[i]parameter2[/i]&amp;[i]parameter3[/i]&amp;...
  update[i](window_options)[/i]:MODELID&amp;[i]parameter1[/i]&amp;[i]parameter2[/i]&amp;[i]parameter3[/i]&amp;...
  savenew[i](window_options)[/i]:MODELID&amp;[i]parameter1[/i]&amp;[i]parameter2[/i]&amp;[i]parameter3[/i]&amp;...
  download[i](window_options)[/i]:MODELID&amp;DOWNLOAD_FIELD=KEY_VALUE_FIELD
  select
  url[i](window_options)[/i]:[i]Relative or Absolute URL, with optional &lt;# #&gt; EJS Parameters[/i]
  js:[i]JavaScript Expression[/i]

[i]parameter[/i] :=
  FIELD_NAME
  FIELD_NAME=NAME_OF_FIELD_WITH_VALUE
  FIELD_NAME='CONSTANT'
  FIELD_NAME=NUMBER
  tabs={\"PARENT_MODEL\":\"SELECTED_TAB_MODEL\"}

[i]window_options[/i] := [i]window_option1=value1[/i],[i]window_option2=value2[/i],[i]window_option3=value3[/i]
[i]window_option[/i] :=
  target     //The link frame target, ex. _blank, _self
  width      //The width of the popup window
  height     //The height of the popup window
  resizable  //Whether or not the window is resizable (1 or 0), IE-only
  scrollbars //Whether or not scrollbars are displayed (1 or 0)
  status     //Whether or not scrollbars are displayed (1 or 0)
  top        //Screen top offset of the window
  left       //Screen left offset of the window
  Any other window parameters supported by window.open

Example Links:
update:C
update:C&C_ID
update:C&C_ID=5
update:C&C_ID=NEW_C_ID
url(target=_blank,width=800,height=600):https://www.example.com
url:/C?action=update&C_ID=&lt;#=data.C_ID#&gt;
js:alert('Test Popup');
</pre>

If a "url" link is used, the following EJS variables can be added, escaped using &lt;# #&gt; tags:
<pre>
data    //The current row's data, ex: data.C_ID
xmodel  //The jsHarmony Model instance
modelid //The jsHarmony Model ID
</pre>

Links are generated based on the current record data.  The following parameters will be added to the querystring, in the following priority (from lowest to highest):
<ul>
  <li>Any of the current page's querystring parameters</li>
  <li>If the action is "insert" or "savenew", any of the parameters in the current row</li>
  <li>If the action is "update", "browse", or "download", the primary key of the target model, if it is in the current row</li>
  <li>Automatic bindings generated by the system, based on the current model and the target model</li>
  <li>Explicitly defined parameters in the link</li>
</ul>

<h3>Popup Windows</h3>
If the target model for a link has the model.popup property set, or if the target is set in window_options, the link will open in a popup window.  Otherwise, the link will open in the same window.

For both form and report
------------------------
Example of each link type
  form
    insert
    browse
    update
    savenew
    download
    url
    js
  grid
    insert
    browse
    update
    savenew
    download
    select
    url
    js

Example of each link parameter type
  update?C
  update?C&c_id
  update?C&c_id=5
  insert?C&c_name='New customer'
  insert?C&c_name='New customer'&c_status='ACTIVE'
  insert?C&c_name=ca_name
  update?C&c_id=5&tabs={\"C\":\"CF\"}

Example of Custom JS links
  Alert
  OpenForm / OpenReport
  Email

Example of URLs with EJS parameters
  Internal URL / form
  External URL
  Email

Examples of browser opening / closing
  Popup
  Popup override to self
  Regular in-line window
  Regular window to Popup


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

<h3>Onclick Event Handler</h3>
Alternatively, the field.onclick event can be bound for a fully custom event handler.
** Example
** Precedence of onclick / link - onclick will override link for button / linkbutton.  For html / link, the onclick will be attached to the body element, not the link.  For html with field.value, onclick will not be applied.

{"control":"button", "value":"Edit Record", "link":"update:FieldStandardControls_Form"},
{"control":"button", "value":"Run JavaScript", "link":"js:XExt.Alert('Sample Popup');"},


<h3>Link / Bindings</h3>

If the link's target model is the same as the current model, all querystring parameters will be copied.

** Select Links